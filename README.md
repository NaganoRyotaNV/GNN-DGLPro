# GNN-DGLPro
このリポジトリは2024/4/10時点のファイルです。
# 各フォルダについて
注意としてファイル名がほぼ同じで拡張子が.ipynbのものと、.pyのものがあります。コード量がほぼ同じに見える場合、中身はほぼ同じです。pythonとノートブックの仕様の違いでファイルパスの書き方が少し異なっている程度です。コード量が違う場合どちらかは途中でやめているだけなので量が多いほうを参照してください。  
ファイル名がtest.ipynbやsome.ipynbのファイルはちょっとしたコードについてどういう挙動や出力がどうなるかなどの落書きみたいなものなので中身に意味はあまりありません。
+ .gitignore

ファイルサイズがでかすぎてGitHubにプッシュできないような画像データセットや自作したグラフデータセットなど、gitの管理対象から除外するファイル・フォルダを指定するファイルです。
+ Readme.md

今読んでいる文章をMarkdown形式で書かれたファイルです。GitHubのリポジトリのページに表示されます。
+ requirements.txt

このリポジトリ内のコードを動かす仮想環境にインストールしたパッケージ一覧です。pipのオプションでこのrequirements.txtを用いて仮想環境を作ることはできますが100％事故るので実行したいファイルのインポート文を見て適宜手入力でインストールしてください。
## any
学部卒時点のコードの実行結果(ネットワークの重みを保存した.pth,何かのデータをプロットした.png,各epochにおけるlossなどをnumpy形式で保存した.npyなど)が格納されています。
ただ、どのコードを実行した結果なのかまったくわからないのでほぼゴミです。
## Classification
このフォルダは主に画像データセットのSTL10を利用したグラフデータによるクラス分類について実験を行っていたファイルがまとめられています。
+ config

学習推論を行うメインのファイルにて複数の条件(使用するアーキテクチャの違い、層数の違い、学習回数の違いなど)を毎回入力するのが面倒なのでそれら複数の条件をまとめたYAML形式のファイルをまとめています。
+ old save

名前の通り昔やった実験の結果をひとまとめにしています。anyファイル同様もはや何の結果かわからないのでゴミです。
+ Patch train

画像をパッチに切ったグラフデータで実験してみよう、をまとめたファイルです。  
\_\_pycahe\__は自作した.pyファイル内の関数やクラスを別のファイルでインポートした際に作成されるキャッシュファイルです。消しても問題はないですが次回そのファイルをインポートしているファイルを実行した際、実行完了までに少し時間がかかります。
+ その他ファイル

学習推論を行うファイルたちです。参照して意味のあるファイルはenhanced_inference.pyとmodels.pyくらいです。models.pyは学習を行う際のネットワークのインスタンスを生成するクラスが複数種類書かれています。アーキテクチャによって書かなければならないことが少し違うため何個か書かれています。  
## garbage
ゴミ箱です。一応残してますが何の結果かわからないので消して問題ないです。
## Graphing
このフォルダが一番カオスです。おおよそとしてデータの加工や主にグラフデータ作成のためのファイルが入っています。  
Graphingフォルダ内のフォルダに入っていない.ipynbなどのファイルについて、主にグラフデータを作成するためのコードが書かれています。ファイル名に画像データセットの名前がある場合そのデータセットについて加工しています。また、patchが名前に含まれている場合画像をパッチに分割してデータを作っています。その他には画像加工を行うコードのチェック用やデータローダーをカスタムするためのコードなどが書かれたファイル、画像増強を行うファイルなどが含まれています。一時画像特徴量を用いたグラフ化を行っていたことがあるのでsiftやakazeを利用しているファイルやその副産物があったりします。
+ runs

PASCAL VOCデータセットの画像に対してYOLOv8で物体領域を切り抜いた後の画像が格納されています。後のグラフ化のためにおいてあるものなので消しても問題はありません。
+ STL10

画像データセットのSTL10の元データ(バイナリファイル)が保存されています。ダウンロードにとても時間がかかるので一応置いてあります。
+ VOC

画像データセットのPASCAL VOCデータセットを格納しています。STL10と同様です。
+ VOC make graph info  
    + info
    PASCAL VOCデータセットに含まれる物体名が書かれたclass_info.txtと、全ファイル名が書かれたimage_names.txtが格納されています。

各オブジェクトが写っている画像ファイル名が書かれたテキストファイルが格納されています。飛行機であればaeroplane_image.txt内のファイル名の画像に写っているという事です。
## ICPKGI
修士で行っていた研究のメインのフォルダです。固有名詞っぽいものがあったほうが管理しやすかったので「画像を用いた擬似知識グラフによる画像分類」(Image classification using pseudo-knowledge graphs with images)を略してICPKGIとしています。名前に擬似知識グラフとあるが全く関係ないです。下記フォルダ以外のファイルはタイトルやメモ書き、コメントが多分あるので頑張って読み解いてください。
+ \_\_pycahe\__,config

上記で説明したとおりです。
+ save

コードの実行結果をまとめたフォルダです。single classフォルダは*1種類の物体について視線方向を予測*する実験の結果を保存しています。さらにその中のフォルダは実験設定をまとめたyamlファイル内に書かれているモデル名で保存されています。中には実行結果(epoch数、正答率、実行時間等)をまとめたyamlファイルやモデルの重みを保存したファイル、各epochにおけるlossなどを保存したnpyファイル、それをプロットした画像を保存しています。  
multi classフォルダは*3種類の物体について物体のクラス予測*する実験の結果を保存しています。ファイルの種類はsingle classと同様です。

+ models

このフォルダは学部時代に作ったCIFAR-10という画像データセットを普通のCNNで学習を行った際の重みを保存したファイルがあります。多分使うことは今後ないのでゴミです。
+ STL10
画像データセットのSTL10の元データ(バイナリファイル)が保存されています。ダウンロードにとても時間がかかるので一応置いてあります。
<!-- [このページ](https://github.com/MakotoKishimoto-OECU/CNN-and-GNN)の発展版 -->
